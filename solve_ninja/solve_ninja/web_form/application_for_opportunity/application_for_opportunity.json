{
 "allow_comments": 0,
 "allow_delete": 0,
 "allow_edit": 0,
 "allow_incomplete": 0,
 "allow_multiple": 0,
 "allow_print": 0,
 "anonymous": 1,
 "apply_document_permissions": 0,
 "button_label": "Submit",
 "client_script": "frappe.web_form.on('opportunity', (field, value) => {\r\n    if (!value) return;\r\n    handle_opportunity_change(value)\r\n});\r\n\r\nfrappe.web_form.after_load = () => {\r\n    const urlParams = new URLSearchParams(window.location.search);\r\n    const route = urlParams.get('route');\r\n   \r\n    if (route) {\r\n        // Call server to fetch Opportunity by route\r\n        frappe.call({\r\n            method: 'solve_ninja.api.opportunity.get_opportunity_by_route',\r\n            args: { opportunity_route:route },\r\n            callback: function(r) {\r\n                if (r.message) {\r\n                    const opportunity_name = r.message.name;\r\n                    frappe.web_form.set_value('opportunity', opportunity_name);\r\n\r\n                    // Trigger logic\r\n                    handle_opportunity_change(opportunity_name);\r\n                }\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n\r\n\r\n// Reusable logic wrapped in a function\r\nfunction handle_opportunity_change(opportunity_name) {\r\n    frappe.call({\r\n        method: 'solve_ninja.api.opportunity.get_opportunity_type',\r\n        args: {\r\n            opportunity_title: opportunity_name\r\n        },\r\n        callback: function(r) {\r\n            if (!r.exc) {\r\n                const opp_type = r.message;\r\n                console.log(\"Opportunity Type:\", opp_type);\r\n\r\n                // First, hide and make all conditional fields optional by default\r\n                const all_fields = [\r\n                    'fund_brief',\r\n                    'pitch_doc',\r\n                    'mentor_help',\r\n                    'speaker_topic',\r\n                    'speaker_doc',\r\n                    'generic',\r\n                    'resume'\r\n                ];\r\n\r\n                all_fields.forEach(field => {\r\n                    frappe.web_form.set_df_property(field, 'hidden', 1);\r\n                    frappe.web_form.set_df_property(field, 'reqd', 0);\r\n                });\r\n\r\n                // Then switch based on the opportunity type\r\n                switch (opp_type) {\r\n                    case 'Funding':\r\n                        frappe.web_form.set_df_property('fund_brief', 'hidden', 0);\r\n                        frappe.web_form.set_df_property('fund_brief', 'reqd', 1);\r\n                        frappe.web_form.set_df_property('pitch_doc', 'hidden', 0);\r\n                        frappe.web_form.set_df_property('pitch_doc', 'reqd', 1);\r\n                        break;\r\n\r\n                    case 'Mentorship':\r\n                        frappe.web_form.set_df_property('mentor_help', 'hidden', 0);\r\n                        frappe.web_form.set_df_property('mentor_help', 'reqd', 1);\r\n                        break;\r\n\r\n                    case 'Speaker':\r\n                        frappe.web_form.set_df_property('speaker_topic', 'hidden', 0);\r\n                        frappe.web_form.set_df_property('speaker_topic', 'reqd', 1);\r\n                        frappe.web_form.set_df_property('speaker_doc', 'hidden', 0);\r\n                        frappe.web_form.set_df_property('speaker_doc', 'reqd', 1);\r\n                        break;\r\n\r\n                    default:\r\n                        // For all other types, show generic + resume\r\n                        frappe.web_form.set_df_property('generic', 'hidden', 0);\r\n                        frappe.web_form.set_df_property('generic', 'reqd', 1);\r\n                        frappe.web_form.set_df_property('resume', 'hidden', 0);\r\n                        frappe.web_form.set_df_property('resume', 'reqd', 1);\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n    });\r\n    \r\n     frappe.call({\r\n            method: 'solve_ninja.api.opportunity.get_opportunity_by_title',\r\n            args: { opportunity_title:opportunity_name },\r\n            callback: function(r) {\r\n                if (r.message) {\r\n                    frappe.web_form.set_value('opp_description', r.message.opp_description);\r\n                    frappe.web_form.set_value('eligibility_criteria',  r.message.eligibility_criteria);\r\n                }\r\n            }\r\n        });\r\n\r\n}\r\n",
 "creation": "2025-07-19 12:09:36.319772",
 "doc_type": "Opportunity Application",
 "docstatus": 0,
 "doctype": "Web Form",
 "idx": 0,
 "introduction_text": "<div class=\"ql-editor read-mode\"><p>Hey, fill the below form to apply for this opportunity</p></div>",
 "is_standard": 1,
 "list_columns": [],
 "login_required": 0,
 "max_attachment_size": 0,
 "modified": "2025-08-01 14:58:14.609030",
 "modified_by": "Administrator",
 "module": "Solve Ninja",
 "name": "application-for-opportunity",
 "owner": "ankit@solveninja.org",
 "published": 1,
 "route": "application-for-opportunity",
 "show_attachments": 0,
 "show_list": 0,
 "show_sidebar": 0,
 "success_message": "Thank you for showing your interest in this opportunity. Our team will get inn touch with you shortly!\n\nSolve Small, Dent Big!",
 "success_title": "Thank you",
 "title": "Application for Opportunity",
 "web_form_fields": [
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "full_name",
   "fieldtype": "Data",
   "hidden": 0,
   "label": "Full Name",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "opportunity",
   "fieldtype": "Link",
   "hidden": 0,
   "label": "Opportunity",
   "max_length": 0,
   "max_value": 0,
   "options": "Opportunity Template",
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "email",
   "fieldtype": "Data",
   "hidden": 0,
   "label": "Email",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "opp_description",
   "fieldtype": "Text",
   "hidden": 0,
   "label": "Opportunity Description",
   "max_length": 0,
   "max_value": 0,
   "read_only": 1,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "eligibility_criteria",
   "fieldtype": "Text",
   "hidden": 0,
   "label": "Eligibility Criteria",
   "max_length": 0,
   "max_value": 0,
   "read_only": 1,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "mentor_help",
   "fieldtype": "Text",
   "hidden": 1,
   "label": "What Help do you need from Mentor",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "speaker_topic",
   "fieldtype": "Text",
   "hidden": 1,
   "label": "Speaker Topic",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "fund_brief",
   "fieldtype": "Text Editor",
   "hidden": 1,
   "label": "Brief Description of Idea for which Fund support is needed",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "pitch_doc",
   "fieldtype": "Attach",
   "hidden": 1,
   "label": "Pitch Document",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "speaker_doc",
   "fieldtype": "Attach",
   "hidden": 1,
   "label": "Speaker Presentation",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "generic",
   "fieldtype": "Text Editor",
   "hidden": 0,
   "label": "Share with us why you would be great candidate for this opportunity?",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "resume",
   "fieldtype": "Attach",
   "hidden": 0,
   "label": "Resume",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  }
 ]
}